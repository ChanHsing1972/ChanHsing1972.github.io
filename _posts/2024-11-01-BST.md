---
title: ğŸ§‘ğŸ»â€ğŸ’» äºŒå‰æœç´¢æ ‘
description: åœ¨ C++ ä¸­ï¼Œå®ç°äºŒå‰æœç´¢æ ‘åŠå…¶ç›¸å…³æ“ä½œçš„æ€è·¯å’Œä»£ç ã€‚ä½œç¬”è®°ç”¨ã€‚
date: 2024-11-01 11:31:40 +0800
categories: [Schoolwork, Notes]
tags: [ç¨‹åº, ç®—æ³•, ä»£ç ]
math: true
image:
  path: ../assets/img/BST.png
---

äºŒå‰æœç´¢æ ‘åˆç§°äºŒå‰æ’åºæ ‘ï¼Œå®ƒæˆ–è€…æ˜¯ä¸€æ£µç©ºæ ‘ï¼Œæˆ–è€…æ˜¯å…·æœ‰ä»¥ä¸‹æ€§è´¨çš„äºŒå‰æ ‘:

- è‹¥å®ƒçš„å·¦å­æ ‘ä¸ä¸ºç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼éƒ½å°äºæ ¹èŠ‚ç‚¹çš„å€¼ï¼›
- è‹¥å®ƒçš„å³å­æ ‘ä¸ä¸ºç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼éƒ½å¤§äºæ ¹èŠ‚ç‚¹çš„å€¼ï¼›
- å®ƒçš„å·¦å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æœç´¢æ ‘ã€‚

```c++
#include <bits/stdc++.h>
using namespace std;

class Node
{
    friend class BST;

private:
    int value;
    Node *left;
    Node *right;

public:
    Node(int val)
    {
        value = val;
        left = nullptr;
        right = nullptr;
    }
};

class BST
{
private:
    Node *root;

public:
    BST()
    {
        root = nullptr;
    }
    Node *search(int key);
    void insert(int val);
    void searchRemove(int val);
    void remove(Node *cur, Node *parent);
};

Node *BST::search(int key)
{
    Node *cur = root;
    while (cur != nullptr)
    {
        if (key < cur->value)
            cur = cur->left;
        else if (key > cur->value)
            cur = cur->right;
        else
            return cur;
    }
    return nullptr;
}

void BST::insert(int val)
{
    if (root == nullptr)
        root = new Node(val);

    Node *cur = root;
    Node *parent = nullptr;

    while (cur != nullptr)
    {
        parent = cur;

        if (val < cur->value)
            cur = cur->left;
        else if (val > cur->value)
            cur = cur->right;
        else
            return;
    }

    if (val < parent->value)
        parent->left = new Node(val);
    else
        parent->right = new Node(val);

    return;
}

// å¯»æ‰¾åˆ é™¤çš„èŠ‚ç‚¹
void BST::searchRemove(int val)
{
    Node *cur = root;
    Node *parent = nullptr;

    while (cur != nullptr)
    {
        if (cur->value > val)
        {
            parent = cur;
            cur = cur->left;
        }
        else if (cur->value < val)
        {
            parent = cur;
            cur = cur->right;
        }
        else
            remove(cur, parent);
    }
    return;
}

// åˆ é™¤èŠ‚ç‚¹çš„å…·ä½“æ“ä½œ
void BST::remove(Node *del, Node *parent)
{
    // è¦åˆ é™¤çš„èŠ‚ç‚¹æ˜¯ delï¼Œå…¶çˆ¶èŠ‚ç‚¹æ˜¯ parent
    // æ ¹æ® del æ˜¯å¦æœ‰å·¦/å³å­æ ‘ï¼Œåˆ†ä¸ºä¸‰ç§æƒ…å†µ

    // Case 1: è¦åˆ é™¤çš„èŠ‚ç‚¹ del æ²¡æœ‰å·¦å­æ ‘ï¼ˆæˆ–ï¼šæ—¢æ²¡æœ‰å·¦å­æ ‘ï¼Œä¹Ÿæ²¡æœ‰å³å­æ ‘ï¼‰
    if (del->left == nullptr)
    {
        if (del == root)
        {                      // å¦‚æœ del æ˜¯æ ¹èŠ‚ç‚¹
            root = del->right; // å°†æ ¹èŠ‚ç‚¹æŒ‡å‘ del çš„å³èŠ‚ç‚¹
        }
        else if (del == parent->right)
        {                               // å¦‚æœ del æ˜¯çˆ¶èŠ‚ç‚¹çš„å³èŠ‚ç‚¹
            parent->right = del->right; // å°†çˆ¶èŠ‚ç‚¹çš„å³èŠ‚ç‚¹æŒ‡å‘ del çš„å³èŠ‚ç‚¹
        }
        else if (del == parent->left)
        {                              // å¦‚æœ del æ˜¯çˆ¶èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹
            parent->left = del->right; // å°†çˆ¶èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹æŒ‡å‘ del çš„å³èŠ‚ç‚¹
        }
    }

    // 2. å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹ del æ²¡æœ‰å³å­æ ‘
    else if (del->right == nullptr)
    {
        if (del == root)
        {                     // å¦‚æœ del æ˜¯æ ¹èŠ‚ç‚¹
            root = del->left; // å°†æ ¹èŠ‚ç‚¹æŒ‡å‘ del çš„å·¦èŠ‚ç‚¹
        }
        else if (del == parent->left)
        {                             // å¦‚æœ del æ˜¯çˆ¶èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹
            parent->left = del->left; // å°†çˆ¶èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹æŒ‡å‘ del çš„å·¦èŠ‚ç‚¹
        }
        else if (del == parent->right)
        {                              // å¦‚æœ del æ˜¯çˆ¶èŠ‚ç‚¹çš„å³èŠ‚ç‚¹
            parent->right = del->left; // å°†çˆ¶èŠ‚ç‚¹çš„å³èŠ‚ç‚¹æŒ‡å‘ del çš„å·¦èŠ‚ç‚¹
        }
    }

    // 3. å¦‚æœ del æ—¢æœ‰å·¦å­æ ‘åˆæœ‰å³å­æ ‘ï¼š
    // æ‰¾åˆ° del çš„å³å­æ ‘ä¸­çš„æœ€å°èŠ‚ç‚¹ï¼Œå³å³å­æ ‘ä¸­çš„æœ€å·¦èŠ‚ç‚¹
    else
    {
        Node *min_node = del->right; // åˆå§‹åŒ–æœ€å°èŠ‚ç‚¹ä¸º del çš„å³èŠ‚ç‚¹
        Node *prev = del;            // è®°å½•æœ€å°èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹

        while (min_node->left != nullptr) // å¦‚æœæœ€å°èŠ‚ç‚¹èƒ½å‘å·¦ç§»åŠ¨
        {
            prev = min_node;           // å…ˆæ›´æ–°æœ€å°èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹
            min_node = min_node->left; // æœ€å°èŠ‚ç‚¹å‘å·¦ç§»åŠ¨
        }
        del->value = min_node->value; // å°† del çš„å€¼æ›´æ–°ä¸ºæœ€å°èŠ‚ç‚¹çš„å€¼

        if (del == prev)
        {                                 // å¦‚æœ del çš„å³å­æ ‘æ²¡æœ‰å·¦èŠ‚ç‚¹ï¼Œ
                                          // å³ del->right->left == NULLï¼Œ
            del->right = min_node->right; // å°† del çš„å³èŠ‚ç‚¹æŒ‡å‘æœ€å°èŠ‚ç‚¹çš„å³èŠ‚ç‚¹
        }
        else if (del != prev)
        {                                 // å¦‚æœ del çš„å³å­æ ‘æœ‰å·¦èŠ‚ç‚¹ï¼Œ
                                          // å³ del->right->left != NULLï¼Œ
            prev->left = min_node->right; // å°†æœ€å°èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹æŒ‡å‘æœ€å°èŠ‚ç‚¹çš„å³èŠ‚ç‚¹
        }
    }
}
```

![pic](../assets/img/remove-in-BST-1.png)
![pic](../assets/img/remove-in-BST-2.png)
![pic](../assets/img/remove-in-BST-3a.png)
![pic](../assets/img/remove-in-BST-3b.png)