---
title: ğŸ§‘ğŸ»â€ğŸ’» äºŒå‰æœç´¢æ ‘
description: åœ¨ C++ ä¸­ï¼Œå®ç°äºŒå‰æœç´¢æ ‘åŠå…¶ç›¸å…³æ“ä½œçš„æ€è·¯å’Œä»£ç ã€‚ä½œç¬”è®°ç”¨ã€‚
date: 2024-11-01 11:31:40 +0800
categories: [Schoolwork, Notes]
tags: [ç¨‹åº, ç®—æ³•, ä»£ç ]
math: true
image:
  path: ../assets/img/BST.png
---

äºŒå‰æœç´¢æ ‘åˆç§°äºŒå‰æ’åºæ ‘ï¼Œå®ƒæˆ–è€…æ˜¯ä¸€æ£µç©ºæ ‘ï¼Œæˆ–è€…æ˜¯å…·æœ‰ä»¥ä¸‹æ€§è´¨çš„äºŒå‰æ ‘:

- è‹¥å®ƒçš„å·¦å­æ ‘ä¸ä¸ºç©ºï¼Œåˆ™å·¦å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼éƒ½å°äºæ ¹èŠ‚ç‚¹çš„å€¼ï¼›
- è‹¥å®ƒçš„å³å­æ ‘ä¸ä¸ºç©ºï¼Œåˆ™å³å­æ ‘ä¸Šæ‰€æœ‰èŠ‚ç‚¹çš„å€¼éƒ½å¤§äºæ ¹èŠ‚ç‚¹çš„å€¼ï¼›
- å®ƒçš„å·¦å³å­æ ‘ä¹Ÿåˆ†åˆ«ä¸ºäºŒå‰æœç´¢æ ‘ã€‚

```c++
#include <bits/stdc++.h>
using namespace std;

class Node
{
    friend class BST;

private:
    int value;
    Node *left;
    Node *right;

public:
    Node(int val)
    {
        value = val;
        left = nullptr;
        right = nullptr;
    }
};

class BST
{
private:
    Node *root;

public:
    BST()
    {
        root = nullptr;
    }
    Node *search(int key);
    void insert(int val);
    void searchRemove(int val);
    void remove(Node *cur, Node *parent);
};

Node *BST::search(int key)
{
    Node *cur = root;
    while (cur != nullptr)
    {
        if (key < cur->value)
            cur = cur->left;
        else if (key > cur->value)
            cur = cur->right;
        else
            return cur;
    }
    return nullptr;
}

void BST::insert(int val)
{
    if (root == nullptr)
        root = new Node(val);

    Node *cur = root;
    Node *parent = nullptr;

    while (cur != nullptr)
    {
        parent = cur;

        if (val < cur->value)
            cur = cur->left;
        else if (val > cur->value)
            cur = cur->right;
        else
            return;
    }

    if (val < parent->value)
        parent->left = new Node(val);
    else
        parent->right = new Node(val);

    return;
}

// å¯»æ‰¾åˆ é™¤çš„èŠ‚ç‚¹
void BST::searchRemove(int val)
{
    Node *cur = root;
    Node *parent = nullptr;

    while (cur != nullptr)
    {
        if (cur->value > val)
        {
            parent = cur;
            cur = cur->left;
        }
        else if (cur->value < val)
        {
            parent = cur;
            cur = cur->right;
        }
        else
            remove(cur, parent);
    }
    return;
}

// åˆ é™¤èŠ‚ç‚¹çš„å…·ä½“æ“ä½œ
void BST::remove(Node *cur, Node *parent)
{
    // å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹æ²¡æœ‰å·¦å­æ ‘
    if (cur->left == nullptr)
    {
        if (cur == root)
        {                      // å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹æ˜¯æ ¹èŠ‚ç‚¹
            root = cur->right; // å°†æ ¹èŠ‚ç‚¹æŒ‡å‘å…¶å³å­èŠ‚ç‚¹
        }
        else if (cur == parent->right)
        {                               // å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹æ˜¯çˆ¶èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹
            parent->right = cur->right; // å°†çˆ¶èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹æŒ‡å‘è¦åˆ é™¤èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹
        }
        else
        {                              // å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹æ˜¯çˆ¶èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹
            parent->left = cur->right; // å°†çˆ¶èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹æŒ‡å‘è¦åˆ é™¤èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹
        }
    }

    // å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹æ²¡æœ‰å³å­æ ‘
    else if (cur->right == nullptr)
    {
        if (cur == root)
        {                     // å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹æ˜¯æ ¹èŠ‚ç‚¹
            root = cur->left; // å°†æ ¹èŠ‚ç‚¹æŒ‡å‘å…¶å·¦å­èŠ‚ç‚¹
        }
        else if (cur == parent->left)
        {                             // å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹æ˜¯çˆ¶èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹
            parent->left = cur->left; // å°†çˆ¶èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹æŒ‡å‘è¦åˆ é™¤èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹
        }
        else
        {                              // å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹æ˜¯çˆ¶èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹
            parent->right = cur->left; // å°†çˆ¶èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹æŒ‡å‘è¦åˆ é™¤èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹
        }
    }

    // å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹æ—¢æœ‰å·¦å­æ ‘åˆæœ‰å³å­æ ‘
    else
    {
        // æ‰¾åˆ°è¦åˆ é™¤èŠ‚ç‚¹çš„å³å­æ ‘ä¸­çš„æœ€å°èŠ‚ç‚¹ï¼Œå³å³å­æ ‘ä¸­çš„æœ€å·¦èŠ‚ç‚¹
        Node *min_node = cur->right;
        Node *prev = cur;

        while (min_node->left != nullptr)
        {
            prev = min_node;           // è®°å½•å½“å‰èŠ‚ç‚¹ä¸ºå‰ä¸€ä¸ªèŠ‚ç‚¹
            min_node = min_node->left; // å‘å·¦ç§»åŠ¨
        }
        cur->value = min_node->value; // å°†å½“å‰èŠ‚ç‚¹çš„å€¼æ›¿æ¢ä¸ºæœ€å°èŠ‚ç‚¹çš„å€¼

        if (cur == prev)
        {                                 // å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹çš„å³å­æ ‘åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹
            cur->right = min_node->right; // å°†å½“å‰èŠ‚ç‚¹çš„å³å­æ ‘æŒ‡å‘æœ€å°èŠ‚ç‚¹çš„å³å­æ ‘
        }
        else
        {                                 // å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹çš„å³å­æ ‘æœ‰å¤šä¸ªèŠ‚ç‚¹
            prev->left = min_node->right; // å°†æœ€å°èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹çš„å·¦å­æ ‘æŒ‡å‘æœ€å°èŠ‚ç‚¹çš„å³å­æ ‘
        }
    }
}
```